"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2481],{8933:(F,p,s)=>{s.d(p,{Jb:()=>h,LK:()=>r,ru:()=>g});var g=function(c){return c.Prompt="PROMPT",c.Camera="CAMERA",c.Photos="PHOTOS",c}(g||{}),h=function(c){return c.Rear="REAR",c.Front="FRONT",c}(h||{}),r=function(c){return c.Uri="uri",c.Base64="base64",c.DataUrl="dataUrl",c}(r||{})},1889:(F,p,s)=>{s.d(p,{Wi:()=>h,__:()=>g});var g=function(i){return i.Documents="DOCUMENTS",i.Data="DATA",i.Library="LIBRARY",i.Cache="CACHE",i.External="EXTERNAL",i.ExternalStorage="EXTERNAL_STORAGE",i}(g||{}),h=function(i){return i.UTF8="utf8",i.ASCII="ascii",i.UTF16="utf16",i}(h||{})},2481:(F,p,s)=>{s.r(p),s.d(p,{HomePageModule:()=>M});var g=s(177),h=s(4341),r=s(9364),c=s(4212),i=s(467),A=s(6955),S=s(3349),e=s(4438),_=s(5083),b=s(8933);const P=(0,_.F3)("Camera",{web:()=>s.e(9141).then(s.bind(s,9141)).then(a=>new a.CameraWeb)});var v=s(1889);const f=(0,_.F3)("Filesystem",{web:()=>s.e(2937).then(s.bind(s,2937)).then(a=>new a.FilesystemWeb)});var j=s(4517);let R=(()=>{var a;class m{constructor(t,o,n){this.platform=t,this.loadingCtrl=o,this.toastCtrl=n,this.IMG_DIR="stored-images",this.images=[],this.convertBlobToBase64=d=>new Promise((u,I)=>{const y=new FileReader;y.onerror=I,y.onload=()=>{u(y.result)},y.readAsDataURL(d)})}formatDate(){const t=new Date;return t.getFullYear()+(t.getMonth()+1).toString().padStart(2,"0")+t.getDate()+"_"+t.getHours().toString().padStart(2,"0")+t.getMinutes().toString().padStart(2,"0")+t.getSeconds().toString().padStart(2,"0")}saveImage(t){var o=this;return(0,i.A)(function*(){let n;n=o.platform.is("hybrid")?yield o.readAsBase64_hybrid(t):yield o.readAsBase64_web(t.webPath);const u=o.formatDate()+".jpeg";yield f.writeFile({path:`${o.IMG_DIR}/${u}`,data:n,directory:v.__.Data}),o.loadFiles(),o.presentToast("File saved")})()}updateImage(t){var o=this;return(0,i.A)(function*(){const n=yield o.readAsBase64_web(t.edited),u=o.formatDate()+"_edited.jpeg";yield f.writeFile({path:`${o.IMG_DIR}/${u}`,data:n,directory:v.__.Data}),o.loadFiles(),o.presentToast("File updated")})()}readAsBase64_hybrid(t){return(0,i.A)(function*(){return(yield f.readFile({path:t.path})).data})()}readAsBase64_web(t){var o=this;return(0,i.A)(function*(){const d=yield(yield fetch(t)).blob();return yield o.convertBlobToBase64(d)})()}takeImage(){var t=this;return(0,i.A)(function*(){try{const o=yield P.getPhoto({resultType:b.LK.Uri,source:b.ru.Camera,quality:100});o.webPath&&(yield t.saveImage(o))}catch{console.log("no photo")}})()}loadImage(){var t=this;return(0,i.A)(function*(){try{const o=yield P.getPhoto({resultType:b.LK.Uri,source:b.ru.Photos,quality:100});o&&(yield t.saveImage(o))}catch{console.log("no photo")}})()}loadFiles(){var t=this;return(0,i.A)(function*(){t.images=[];const o=yield t.loadingCtrl.create({message:"loading images..."});yield o.present(),f.readdir({path:t.IMG_DIR,directory:v.__.Data}).then(n=>{t.loadFileData(n.files.map(d=>d.name))},function(){var n=(0,i.A)(function*(d){console.log("error loading: "+d),yield f.mkdir({directory:v.__.Data,path:t.IMG_DIR})});return function(d){return n.apply(this,arguments)}}()).then(n=>{o.dismiss()})})()}loadFileData(t){var o=this;return(0,i.A)(function*(){for(let n of t){const d=`${o.IMG_DIR}/${n}`,u=localStorage.getItem(n),I=yield f.readFile({path:d,directory:v.__.Data});o.images.unshift({name:n,path:d,data:`data:image/jpeg;base64,${I.data}`,edited:"",details:u})}})()}deleteImage(t){var o=this;return(0,i.A)(function*(){yield f.deleteFile({directory:v.__.Data,path:t.path}),localStorage.removeItem(t.name),o.loadFiles(),o.presentToast("File removed")})()}presentToast(t){var o=this;return(0,i.A)(function*(){(yield o.toastCtrl.create({message:t,duration:3e3})).present()})()}}return(a=m).\u0275fac=function(t){return new(t||a)(e.KVO(j.OD),e.KVO(r.Xi),e.KVO(r.K_))},a.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}),m})();function D(a,m){if(1&a&&(e.j41(0,"ion-card-content",24),e.EFF(1),e.k0s()),2&a){const l=e.XpG().$implicit;e.R7$(),e.SpI(" ",l.details," ")}}function H(a,m){if(1&a){const l=e.RV6();e.j41(0,"ion-col",13)(1,"ion-card",14),e.nrm(2,"ion-img",15),e.j41(3,"ion-card-header",16)(4,"ion-card-subtitle"),e.EFF(5),e.k0s()(),e.nrm(6,"br"),e.DNE(7,D,2,1,"ion-card-content",17),e.j41(8,"ion-button",18),e.nrm(9,"ion-icon",19),e.j41(10,"ion-label"),e.EFF(11,"Analyze"),e.k0s()(),e.j41(12,"ion-button",20),e.bIt("click",function(){const o=e.eBV(l).$implicit,n=e.XpG();return e.Njj(n.editImage(o))}),e.nrm(13,"ion-icon",21),e.j41(14,"ion-label"),e.EFF(15,"Edit image"),e.k0s()(),e.j41(16,"ion-button",20),e.bIt("click",function(){const o=e.eBV(l).$implicit,n=e.XpG();return e.Njj(n.editInfo(o))}),e.nrm(17,"ion-icon",21),e.j41(18,"ion-label"),e.EFF(19,"Edit info"),e.k0s()(),e.j41(20,"ion-button",22),e.bIt("click",function(){const o=e.eBV(l).$implicit,n=e.XpG();return e.Njj(n.deleteImage(o))}),e.nrm(21,"ion-icon",23),e.j41(22,"ion-label"),e.EFF(23,"Remove"),e.k0s()()()()}if(2&a){const l=m.$implicit;e.R7$(2),e.Y8G("src",l.data),e.R7$(3),e.JRh(l.name),e.R7$(2),e.Y8G("ngIf",l.details)}}const T=[{path:"",component:(()=>{var a;class m{constructor(t,o){this.cameraService=t,this.modalCtrl=o,this.images=[]}ngOnInit(){}ionViewDidEnter(){this.cameraService.loadFiles(),this.images=this.cameraService.images}takeImage(){var t=this;return(0,i.A)(function*(){yield t.cameraService.takeImage(),t.images=t.cameraService.images})()}loadImage(){var t=this;return(0,i.A)(function*(){yield t.cameraService.loadImage(),t.images=t.cameraService.images})()}editImage(t){var o=this;return(0,i.A)(function*(){const n=yield o.modalCtrl.create({component:A.o,componentProps:{image:t}});return n.onDidDismiss().then(d=>{const u=d.data;null!=u&&o.updateImage(u)}),yield n.present()})()}editInfo(t){var o=this;return(0,i.A)(function*(){return yield(yield o.modalCtrl.create({component:S.P,componentProps:{image:t}})).present()})()}updateImage(t){var o=this;return(0,i.A)(function*(){yield o.cameraService.updateImage(t),o.images=o.cameraService.images})()}deleteImage(t){var o=this;return(0,i.A)(function*(){yield o.cameraService.deleteImage(t),o.images=o.cameraService.images})()}}return(a=m).\u0275fac=function(t){return new(t||a)(e.rXU(R),e.rXU(r.W3))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-home"]],decls:22,vars:3,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["size","12","size-Xs","6","size-sm","6","size-Md","3",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","wood"],["name","add"],["side","top"],["color","wood-second",3,"click"],["name","attach"],["name","camera"],["size","12","size-Xs","6","size-sm","6","size-Md","3"],["color","wood",2,"padding","0.5em"],["alt","image",2,"height","10em",3,"src"],[2,"padding","0","padding-top","1em"],["style","padding: 0; padding-bottom: 1em;",4,"ngIf"],["expand","full","color","cocobolo"],["slot","start","name","search-outline"],["expand","full","color","medium",3,"click"],["slot","start","name","create-outline"],["expand","full","color","danger",3,"click"],["slot","start","name","trash-outline"],[2,"padding","0","padding-bottom","1em"]],template:function(t,o){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Home"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e.EFF(10,"Home"),e.k0s()()(),e.j41(11,"ion-grid")(12,"ion-row"),e.DNE(13,H,24,3,"ion-col",5),e.k0s()(),e.j41(14,"ion-fab",6)(15,"ion-fab-button",7),e.nrm(16,"ion-icon",8),e.k0s(),e.j41(17,"ion-fab-list",9)(18,"ion-fab-button",10),e.bIt("click",function(){return o.loadImage()}),e.nrm(19,"ion-icon",11),e.k0s(),e.j41(20,"ion-fab-button",10),e.bIt("click",function(){return o.takeImage()}),e.nrm(21,"ion-icon",12),e.k0s()()()()),2&t&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(7),e.Y8G("ngForOf",o.images))},dependencies:[g.Sq,g.bT,r.Jm,r.QW,r.b_,r.I9,r.ME,r.HW,r.hU,r.W9,r.Q8,r.YW,r.OL,r.lO,r.eU,r.iq,r.KW,r.he,r.MC,r.ln,r.BC,r.ai]}),m})()}];let E=(()=>{var a;class m{}return(a=m).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[c.iI.forChild(T),c.iI]}),m})(),M=(()=>{var a;class m{}return(a=m).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[g.MD,h.YN,r.bv,E]}),m})()}}]);