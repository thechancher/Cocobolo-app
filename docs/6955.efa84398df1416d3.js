"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6955],{6955:(J,H,u)=>{u.d(H,{o:()=>U});var C=u(467),i=u(4438),_=u(9364),W=u(3800);const F=["cropper"];let U=(()=>{var S;class O{constructor(m,g){this.loadingCtrl=m,this.modalCtrl=g,this.width=0,this.height=0}ngOnInit(){var m=this;return(0,C.A)(function*(){yield(yield m.loadingCtrl.create()).present()})()}imageLoaded(){this.loadingCtrl.dismiss()}loadImageFailed(){console.log("Image load failed")}imageCropped(m){this.image.edited=m.objectUrl||m.base64||"",this.width=m.width,this.height=m.height}increaseCrop(){var m=this.cropper.cropper.x2,g=this.cropper.cropper.y2;this.cropper.cropper={x1:this.cropper.cropper.x1,y1:this.cropper.cropper.y1,x2:m+=.5,y2:g+=.5},this.cropper.crop()}decreaseCrop(){var m=this.cropper.cropper.x2,g=this.cropper.cropper.y2;this.cropper.cropper={x1:this.cropper.cropper.x1,y1:this.cropper.cropper.y1,x2:m-=.5,y2:g-=.5},this.cropper.crop()}cropImage(){this.modalCtrl.dismiss(this.image)}discardChange(){this.modalCtrl.dismiss(null)}}return(S=O).\u0275fac=function(m){return new(m||S)(i.rXU(_.Xi),i.rXU(_.W3))},S.\u0275cmp=i.VBU({type:S,selectors:[["app-edit"]],viewQuery:function(m,g){if(1&m&&i.GBs(F,5),2&m){let f;i.mGM(f=i.lsd())&&(g.cropper=f.first)}},inputs:{image:"image"},decls:40,vars:9,consts:[["cropper",""],[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],["color","cocobolo",3,"click"],["name","cut-outline"],["color","danger",3,"click"],["name","close-outline"],["size","12","size-Xs","6"],[3,"click"],["outputType","base64","format","jpeg",3,"imageLoaded","loadImageFailed","imageCropped","imageBase64","aspectRatio","maintainAspectRatio","imageQuality"],[2,"height","50%",3,"src"]],template:function(m,g){if(1&m){const f=i.RV6();i.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),i.EFF(3,"Edit"),i.k0s()()(),i.j41(4,"ion-content",2)(5,"ion-header",3)(6,"ion-toolbar")(7,"ion-title",4),i.EFF(8,"Edit"),i.k0s()()(),i.j41(9,"ion-content")(10,"ion-grid")(11,"ion-row")(12,"ion-button",5),i.bIt("click",function(){return i.eBV(f),i.Njj(g.cropImage())}),i.nrm(13,"ion-icon",6),i.j41(14,"ion-label"),i.EFF(15,"Crop image"),i.k0s()(),i.j41(16,"ion-button",7),i.bIt("click",function(){return i.eBV(f),i.Njj(g.discardChange())}),i.nrm(17,"ion-icon",8),i.j41(18,"ion-label"),i.EFF(19,"Discard changes"),i.k0s()()(),i.j41(20,"ion-row")(21,"ion-col",9)(22,"h4"),i.EFF(23,"Original"),i.k0s(),i.j41(24,"ion-button",10),i.bIt("click",function(){return i.eBV(f),i.Njj(g.increaseCrop())}),i.EFF(25,"+"),i.k0s(),i.j41(26,"ion-button",10),i.bIt("click",function(){return i.eBV(f),i.Njj(g.decreaseCrop())}),i.EFF(27,"-"),i.k0s(),i.j41(28,"image-cropper",11,0),i.bIt("imageLoaded",function(){return i.eBV(f),i.Njj(g.imageLoaded())})("loadImageFailed",function(){return i.eBV(f),i.Njj(g.loadImageFailed())})("imageCropped",function(V){return i.eBV(f),i.Njj(g.imageCropped(V))}),i.k0s()(),i.nrm(30,"br"),i.j41(31,"ion-col",9)(32,"h4"),i.EFF(33,"Preview"),i.k0s(),i.j41(34,"ion-label"),i.EFF(35),i.k0s(),i.nrm(36,"br"),i.j41(37,"ion-label"),i.EFF(38),i.k0s(),i.nrm(39,"ion-img",12),i.k0s()()()()()}2&m&&(i.Y8G("translucent",!0),i.R7$(4),i.Y8G("fullscreen",!0),i.R7$(24),i.Y8G("imageBase64",g.image.data)("aspectRatio",1)("maintainAspectRatio",!0)("imageQuality",100),i.R7$(7),i.SpI("Weight: ",g.width,""),i.R7$(3),i.SpI("Height: ",g.height,""),i.R7$(),i.Y8G("src",g.image.edited))},dependencies:[_.Jm,_.hU,_.W9,_.lO,_.eU,_.iq,_.KW,_.he,_.ln,_.BC,_.ai,W._D],styles:["image-cropper[_ngcontent-%COMP%]{--cropper-outline-color: rgba(0, 0, 0, .7);--cropper-overlay-color: var(--ion-background-color)}"]}),O})()},3800:(J,H,u)=>{u.d(H,{_D:()=>mt,xv:()=>ut});var C=u(467),i=u(4438),_=u(345),W=u(6977),F=u(1594),U=u(6365),S=u(8750),O=u(983),z=u(3794),m=u(6648);function g(...s){const c=(0,z.lI)(s),t=(0,z.R0)(s,1/0),e=s;return e.length?1===e.length?(0,S.Tg)(e[0]):(0,U.U)(t)((0,m.H)(e,c)):O.w}var f=u(3726),R=u(177);const V=["wrapper"],Z=["sourceImage"];function q(s,c){if(1&s){const t=i.RV6();i.j41(0,"img",5,1),i.bIt("load",function(){i.eBV(t);const r=i.XpG();return i.Njj(r.imageLoadedInView())})("mousedown",function(r){i.eBV(t);const a=i.XpG();return i.Njj(a.startMove(r,a.moveTypes.Drag))})("touchstart",function(r){i.eBV(t);const a=i.XpG();return i.Njj(a.startMove(r,a.moveTypes.Drag))})("error",function(r){i.eBV(t);const a=i.XpG();return i.Njj(a.loadImageError(r))}),i.k0s()}if(2&s){const t=i.XpG();i.xc7("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),i.AVh("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),i.Y8G("src",t.safeImgDataUrl,i.B4B),i.BMQ("alt",t.imageAltText)}}function tt(s,c){if(1&s){const t=i.RV6();i.qex(0),i.j41(1,"span",9),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"topleft"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"topleft"))}),i.nrm(2,"span",10),i.k0s(),i.j41(3,"span",11),i.nrm(4,"span",10),i.k0s(),i.j41(5,"span",12),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"topright"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"topright"))}),i.nrm(6,"span",10),i.k0s(),i.j41(7,"span",13),i.nrm(8,"span",10),i.k0s(),i.j41(9,"span",14),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"bottomright"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"bottomright"))}),i.nrm(10,"span",10),i.k0s(),i.j41(11,"span",15),i.nrm(12,"span",10),i.k0s(),i.j41(13,"span",16),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"bottomleft"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"bottomleft"))}),i.nrm(14,"span",10),i.k0s(),i.j41(15,"span",17),i.nrm(16,"span",10),i.k0s(),i.j41(17,"span",18),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"top"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"top"))}),i.k0s(),i.j41(18,"span",19),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"right"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"right"))}),i.k0s(),i.j41(19,"span",20),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"bottom"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"bottom"))}),i.k0s(),i.j41(20,"span",21),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"left"))})("touchstart",function(r){i.eBV(t);const a=i.XpG(2);return i.Njj(a.startMove(r,a.moveTypes.Resize,"left"))}),i.k0s(),i.bVm()}}function et(s,c){if(1&s){const t=i.RV6();i.j41(0,"div",6),i.bIt("keydown",function(r){i.eBV(t);const a=i.XpG();return i.Njj(a.keyboardAccess(r))}),i.j41(1,"div",7),i.bIt("mousedown",function(r){i.eBV(t);const a=i.XpG();return i.Njj(a.startMove(r,a.moveTypes.Move))})("touchstart",function(r){i.eBV(t);const a=i.XpG();return i.Njj(a.startMove(r,a.moveTypes.Move))}),i.k0s(),i.DNE(2,tt,21,0,"ng-container",8),i.k0s()}if(2&s){const t=i.XpG();i.xc7("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),i.AVh("ngx-ic-round",t.roundCropper),i.BMQ("aria-label",t.cropperFrameAriaLabel),i.R7$(2),i.Y8G("ngIf",!t.hideResizeSquares)}}class it{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t]),this.validateOptions()}setOptionsFromChanges(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var y=function(s){return s.Drag="drag",s.Move="move",s.Resize="resize",s.Pinch="pinch",s}(y||{});function L(s,c){return s/100*c}let st=(()=>{class s{crop(t,e,r,a,o){const n=this.getImagePosition(t,e,r,o),h=n.x2-n.x1,l=n.y2-n.y1,p=document.createElement("canvas");p.width=h,p.height=l;const d=p.getContext("2d");if(!d)return null;null!=r.backgroundColor&&(d.fillStyle=r.backgroundColor,d.fillRect(0,0,h,l));const x=(r.transform.scale||1)*(r.transform.flipH?-1:1),A=(r.transform.scale||1)*(r.transform.flipV?-1:1),{translateH:v,translateV:I}=this.getCanvasTranslate(t,r,o),w=t.transformed;d.setTransform(x,0,0,A,w.size.width/2+v,w.size.height/2+I),d.translate(-n.x1/x,-n.y1/A),d.rotate((r.transform.rotate||0)*Math.PI/180),d.drawImage(w.image,-w.size.width/2,-w.size.height/2);const b={width:h,height:l,imagePosition:n,cropperPosition:{...e}};r.containWithinAspectRatio&&(b.offsetImagePosition=this.getOffsetImagePosition(t,e,r,o));const M=this.getResizeRatio(h,l,r);return 1!==M&&(b.width=Math.round(h*M),b.height=r.maintainAspectRatio?Math.round(b.width/r.aspectRatio):Math.round(l*M),function nt(s,c,t){const e=s.width,r=s.height,a=e/(c=Math.round(c)),o=r/(t=Math.round(t)),n=Math.ceil(a/2),h=Math.ceil(o/2),l=s.getContext("2d");if(l){const p=l.getImageData(0,0,e,r),d=l.createImageData(c,t),x=p.data,A=d.data;for(let v=0;v<t;v++)for(let I=0;I<c;I++){const w=4*(I+v*c),b=v*o;let M=0,j=0,X=0,G=0,Y=0,N=0,P=0;const ft=Math.floor(I*a),xt=Math.floor(v*o);let D=Math.ceil((I+1)*a),Q=Math.ceil((v+1)*o);D=Math.min(D,e),Q=Math.min(Q,r);for(let T=xt;T<Q;T++){const $=Math.abs(b-T)/h,_t=I*a,Mt=$*$;for(let k=ft;k<D;k++){const K=Math.abs(_t-k)/n,B=Math.sqrt(Mt+K*K);if(B>=1)continue;M=2*B*B*B-3*B*B+1;const E=4*(k+T*e);P+=M*x[E+3],X+=M,x[E+3]<255&&(M=M*x[E+3]/250),G+=M*x[E],Y+=M*x[E+1],N+=M*x[E+2],j+=M}}A[w]=G/j,A[w+1]=Y/j,A[w+2]=N/j,A[w+3]=P/X}s.width=c,s.height=t,l.putImageData(d,0,0)}}(p,b.width,b.height)),"blob"===a?this.cropToBlob(b,p,r):(b.base64=p.toDataURL("image/"+r.format,this.getQuality(r)),b)}cropToBlob(t,e,r){var a=this;return(0,C.A)(function*(){return t.blob=yield new Promise(o=>e.toBlob(o,"image/"+r.format,a.getQuality(r))),t.blob&&(t.objectUrl=URL.createObjectURL(t.blob)),t})()}getCanvasTranslate(t,e,r){if("px"===e.transform.translateUnit){const a=this.getRatio(t,r);return{translateH:(e.transform.translateH||0)*a,translateV:(e.transform.translateV||0)*a}}return{translateH:e.transform.translateH?L(e.transform.translateH,t.transformed.size.width):0,translateV:e.transform.translateV?L(e.transform.translateV,t.transformed.size.height):0}}getRatio(t,e){return t.transformed.size.width/e.width}getImagePosition(t,e,r,a){const o=this.getRatio(t,a),n={x1:Math.round(e.x1*o),y1:Math.round(e.y1*o),x2:Math.round(e.x2*o),y2:Math.round(e.y2*o)};return r.containWithinAspectRatio||(n.x1=Math.max(n.x1,0),n.y1=Math.max(n.y1,0),n.x2=Math.min(n.x2,t.transformed.size.width),n.y2=Math.min(n.y2,t.transformed.size.height)),n}getOffsetImagePosition(t,e,r,a){const o=r.canvasRotation+t.exifTransform.rotate,n=this.getRatio(t,a);let h,l;o%2?(h=(t.transformed.size.width-t.original.size.height)/2,l=(t.transformed.size.height-t.original.size.width)/2):(h=(t.transformed.size.width-t.original.size.width)/2,l=(t.transformed.size.height-t.original.size.height)/2);const p={x1:Math.round(e.x1*n)-h,y1:Math.round(e.y1*n)-l,x2:Math.round(e.x2*n)-h,y2:Math.round(e.y2*n)-l};return r.containWithinAspectRatio||(p.x1=Math.max(p.x1,0),p.y1=Math.max(p.y1,0),p.x2=Math.min(p.x2,t.transformed.size.width),p.y2=Math.min(p.y2,t.transformed.size.height)),p}getResizeRatio(t,e,r){const a=r.resizeToWidth/t,o=r.resizeToHeight/e,n=new Array;r.resizeToWidth>0&&n.push(a),r.resizeToHeight>0&&n.push(o);const h=0===n.length?1:Math.min(...n);return h>1&&!r.onlyScaleDown?h:Math.min(h,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=i.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ct=(()=>{class s{resetCropperPosition(t,e,r,a){if(null!=t&&t.nativeElement)if(r.cropperStaticHeight&&r.cropperStaticWidth)e.x1=0,e.x2=a.width>r.cropperStaticWidth?r.cropperStaticWidth:a.width,e.y1=0,e.y2=a.height>r.cropperStaticHeight?r.cropperStaticHeight:a.height;else{const o=Math.min(r.cropperScaledMaxWidth,a.width),n=Math.min(r.cropperScaledMaxHeight,a.height);if(r.maintainAspectRatio)if(a.width/r.aspectRatio<a.height){e.x1=0,e.x2=o;const h=o/r.aspectRatio;e.y1=(a.height-h)/2,e.y2=e.y1+h}else{e.y1=0,e.y2=n;const h=n*r.aspectRatio;e.x1=(a.width-h)/2,e.x2=e.x1+h}else e.x1=0,e.x2=o,e.y1=0,e.y2=n}}move(t,e,r){const a=this.getClientX(t)-e.clientX,o=this.getClientY(t)-e.clientY;r.x1=e.x1+a,r.y1=e.y1+o,r.x2=e.x2+a,r.y2=e.y2+o}resize(t,e,r,a,o){const n=this.getClientX(t)-e.clientX,h=this.getClientY(t)-e.clientY;switch(e.position){case"left":r.x1=Math.min(Math.max(e.x1+n,r.x2-o.cropperScaledMaxWidth),r.x2-o.cropperScaledMinWidth);break;case"topleft":r.x1=Math.min(Math.max(e.x1+n,r.x2-o.cropperScaledMaxWidth),r.x2-o.cropperScaledMinWidth),r.y1=Math.min(Math.max(e.y1+h,r.y2-o.cropperScaledMaxHeight),r.y2-o.cropperScaledMinHeight);break;case"top":r.y1=Math.min(Math.max(e.y1+h,r.y2-o.cropperScaledMaxHeight),r.y2-o.cropperScaledMinHeight);break;case"topright":r.x2=Math.max(Math.min(e.x2+n,r.x1+o.cropperScaledMaxWidth),r.x1+o.cropperScaledMinWidth),r.y1=Math.min(Math.max(e.y1+h,r.y2-o.cropperScaledMaxHeight),r.y2-o.cropperScaledMinHeight);break;case"right":r.x2=Math.max(Math.min(e.x2+n,r.x1+o.cropperScaledMaxWidth),r.x1+o.cropperScaledMinWidth);break;case"bottomright":r.x2=Math.max(Math.min(e.x2+n,r.x1+o.cropperScaledMaxWidth),r.x1+o.cropperScaledMinWidth),r.y2=Math.max(Math.min(e.y2+h,r.y1+o.cropperScaledMaxHeight),r.y1+o.cropperScaledMinHeight);break;case"bottom":r.y2=Math.max(Math.min(e.y2+h,r.y1+o.cropperScaledMaxHeight),r.y1+o.cropperScaledMinHeight);break;case"bottomleft":r.x1=Math.min(Math.max(e.x1+n,r.x2-o.cropperScaledMaxWidth),r.x2-o.cropperScaledMinWidth),r.y2=Math.max(Math.min(e.y2+h,r.y1+o.cropperScaledMaxHeight),r.y1+o.cropperScaledMinHeight);break;case"center":const l=t.scale,p=Math.min(Math.max(o.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*l),o.cropperScaledMaxWidth),d=Math.min(Math.max(o.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*l),o.cropperScaledMaxHeight);r.x1=e.clientX-p/2,r.x2=e.clientX+p/2,r.y1=e.clientY-d/2,r.y2=e.clientY+d/2,r.x1<0?(r.x2-=r.x1,r.x1=0):r.x2>a.width&&(r.x1-=r.x2-a.width,r.x2=a.width),r.y1<0?(r.y2-=r.y1,r.y1=0):r.y2>a.height&&(r.y1-=r.y2-a.height,r.y2=a.height)}o.maintainAspectRatio&&this.checkAspectRatio(e.position,r,a,o)}checkAspectRatio(t,e,r,a){let o=0,n=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*a.aspectRatio,o=Math.max(e.x2-r.width,0),n=Math.max(0-e.y1,0),(o>0||n>0)&&(e.x2-=n*a.aspectRatio>o?n*a.aspectRatio:o,e.y1+=n*a.aspectRatio>o?n:o/a.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*a.aspectRatio,o=Math.max(e.x2-r.width,0),n=Math.max(e.y2-r.height,0),(o>0||n>0)&&(e.x2-=n*a.aspectRatio>o?n*a.aspectRatio:o,e.y2-=n*a.aspectRatio>o?n:o/a.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/a.aspectRatio,o=Math.max(0-e.x1,0),n=Math.max(0-e.y1,0),(o>0||n>0)&&(e.x1+=n*a.aspectRatio>o?n*a.aspectRatio:o,e.y1+=n*a.aspectRatio>o?n:o/a.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/a.aspectRatio,o=Math.max(e.x2-r.width,0),n=Math.max(0-e.y1,0),(o>0||n>0)&&(e.x2-=n*a.aspectRatio>o?n*a.aspectRatio:o,e.y1+=n*a.aspectRatio>o?n:o/a.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/a.aspectRatio,o=Math.max(e.x2-r.width,0),n=Math.max(e.y2-r.height,0),(o>0||n>0)&&(e.x2-=n*a.aspectRatio>o?n*a.aspectRatio:o,e.y2-=n*a.aspectRatio>o?n:o/a.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/a.aspectRatio,o=Math.max(0-e.x1,0),n=Math.max(e.y2-r.height,0),(o>0||n>0)&&(e.x1+=n*a.aspectRatio>o?n*a.aspectRatio:o,e.y2-=n*a.aspectRatio>o?n:o/a.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*a.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/a.aspectRatio;const h=Math.max(0-e.x1,0),l=Math.max(e.x2-r.width,0),p=Math.max(e.y2-r.height,0),d=Math.max(0-e.y1,0);(h>0||l>0||p>0||d>0)&&(e.x1+=p*a.aspectRatio>h?p*a.aspectRatio:h,e.x2-=d*a.aspectRatio>l?d*a.aspectRatio:l,e.y1+=d*a.aspectRatio>l?d:l/a.aspectRatio,e.y2-=p*a.aspectRatio>h?p:h/a.aspectRatio)}}getClientX(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e[0].clientX)||t.clientX||0}getClientY(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e[0].clientY)||t.clientY||0}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=i.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();let dt=(()=>{class s{constructor(){this.autoRotateSupported=function pt(){return new Promise(s=>{const c=new Image;c.onload=()=>{s(1===c.width&&2===c.height)},c.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,e){var r=this;return(0,C.A)(function*(){const a=yield t.arrayBuffer();return yield r.checkImageTypeAndLoadImageFromArrayBuffer(a,t.type,e)})()}checkImageTypeAndLoadImageFromArrayBuffer(t,e,r){return this.isValidImageType(e)?this.loadImageFromArrayBuffer(t,r,e):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,e){var r=this;return(0,C.A)(function*(){const o=yield(yield fetch(t)).blob(),n=yield o.arrayBuffer();return yield r.loadImageFromArrayBuffer(n,e,o.type)})()}loadBase64Image(t,e){const r=this.base64ToArrayBuffer(t);return this.loadImageFromArrayBuffer(r,e)}base64ToArrayBuffer(t){t=t.replace(/^data:([^;]+);base64,/gim,"");const e=atob(t),r=e.length,a=new Uint8Array(r);for(let o=0;o<r;o++)a[o]=e.charCodeAt(o);return a.buffer}loadImageFromArrayBuffer(t,e,r){var a=this;return(0,C.A)(function*(){const o=yield new Promise(function(){var n=(0,C.A)(function*(h,l){try{const p=new Blob([t],r?{type:r}:void 0),d=URL.createObjectURL(p),x=new Image,v="image/svg+xml"===r?yield a.getSvgImageSize(p):void 0;x.onload=()=>h({originalImage:x,originalImageSize:v,originalObjectUrl:d,originalArrayBuffer:t}),x.onerror=l,x.src=d}catch(p){l(p)}});return function(h,l){return n.apply(this,arguments)}}());return yield a.transformImageFromArrayBuffer(o,e,null!=o.originalImageSize)})()}getSvgImageSize(t){return(0,C.A)(function*(){const a=(new DOMParser).parseFromString(yield t.text(),"image/svg+xml").querySelector("svg");if(!a)throw Error("Failed to parse SVG image");const o=a.getAttribute("width"),n=a.getAttribute("height");if(o&&n)return null;const h=a.getAttribute("viewBox")||a.getAttribute("viewbox");if(h){const l=h.split(" ");return{width:+l[2],height:+l[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})()}transformImageFromArrayBuffer(t,e,r=!1){var a=this;return(0,C.A)(function*(){var o;const h=function lt(s){switch("object"==typeof s&&(s=function gt(s){const c=new DataView(s);if(65496!==c.getUint16(0,!1))return-2;const t=c.byteLength;let e=2;for(;e<t;){if(c.getUint16(e+2,!1)<=8)return-1;const r=c.getUint16(e,!1);if(e+=2,65505==r){if(1165519206!==c.getUint32(e+=2,!1))return-1;const a=18761==c.getUint16(e+=6,!1);e+=c.getUint32(e+4,a);const o=c.getUint16(e,a);e+=2;for(let n=0;n<o;n++)if(274==c.getUint16(e+12*n,a))return c.getUint16(e+12*n+8,a)}else{if(65280&~r)break;e+=c.getUint16(e,!1)}}return-1}(s)),s){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}((yield a.autoRotateSupported)?-1:t.originalArrayBuffer);if(!t.originalImage||!t.originalImage.complete)return Promise.reject(new Error("No image loaded"));const l={original:{objectUrl:t.originalObjectUrl,image:t.originalImage,size:null!==(o=t.originalImageSize)&&void 0!==o?o:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:h};return a.transformLoadedImage(l,e,r)})()}transformLoadedImage(t,e,r=!1){var a=this;return(0,C.A)(function*(){const o=e.canvasRotation+t.exifTransform.rotate,n=t.original.size;if(!r&&0===o&&!t.exifTransform.flip&&!e.containWithinAspectRatio)return{original:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...n}},transformed:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...n}},exifTransform:t.exifTransform};const h=a.getTransformedSize(n,t.exifTransform,e),l=document.createElement("canvas");l.width=h.width,l.height=h.height;const p=l.getContext("2d");null==p||p.setTransform(t.exifTransform.flip?-1:1,0,0,1,l.width/2,l.height/2),null==p||p.rotate(Math.PI*(o/2)),null==p||p.drawImage(t.original.image,-n.width/2,-n.height/2);const d=yield new Promise(v=>l.toBlob(v,e.format));if(!d)throw new Error("Failed to get Blob for transformed image.");const x=URL.createObjectURL(d),A=yield a.loadImageFromObjectUrl(x);return{original:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...n}},transformed:{objectUrl:x,image:A,size:{width:A.width,height:A.height}},exifTransform:t.exifTransform}})()}loadImageFromObjectUrl(t){return new Promise((e,r)=>{const a=new Image;a.onload=()=>e(a),a.onerror=r,a.src=t})}getTransformedSize(t,e,r){const a=r.canvasRotation+e.rotate;if(r.containWithinAspectRatio){if(a%2){const n=t.height/r.aspectRatio;return{width:Math.max(t.height,t.width*r.aspectRatio),height:Math.max(t.width,n)}}{const n=t.width/r.aspectRatio;return{width:Math.max(t.width,t.height*r.aspectRatio),height:Math.max(t.height,n)}}}return a%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=i.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),mt=(()=>{class s{constructor(t,e,r,a,o,n,h){this.cropService=t,this.cropperPositionService=e,this.loadImageService=r,this.sanitizer=a,this.cd=o,this.zone=n,this.hammerLoader=h,this.settings=new it,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=y,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new i.bkB,this.startCropImage=new i.bkB,this.imageLoaded=new i.bkB,this.cropperReady=new i.bkB,this.loadImageFailed=new i.bkB,this.transformChange=new i.bkB,this.reset()}ngOnChanges(t){var e;this.onChangesUpdateSettings(t),this.onChangesInputImage(t),null!==(e=this.loadedImage)&&void 0!==e&&e.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!t.maintainAspectRatio&&!t.aspectRatio?t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var t;return(null===(t=this.imageChangedEvent)||void 0===t||null===(t=t.target)||void 0===t||null===(t=t.files)||void 0===t?void 0:t.length)>0}setCssTransform(){var t;const e=(null===(t=this.transform)||void 0===t?void 0:t.translateUnit)||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${e}, ${this.transform.translateV||0}${e}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.objectUrl),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var t;return(null===(t=this.sourceImage)||void 0===t||null===(t=t.nativeElement)||void 0===t?void 0:t.offsetWidth)>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{const t={...this.maxSize};this.setMaxSize(),this.resizeCropperPosition(t),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){var t=this;return(0,C.A)(function*(){var e,r;yield null===(e=t.hammerLoader)||void 0===e?void 0:e.call(t);const a=(null===(r=window)||void 0===r?void 0:r.Hammer)||null;if(a){const o=new a(t.wrapper.nativeElement);o.get("pinch").set({enable:!0}),o.on("pinchmove",t.onPinch.bind(t)),o.on("pinchend",t.pinchStop.bind(t)),o.on("pinchstart",t.startPinch.bind(t))}else(0,i.naY)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})()}resizeCropperPosition(t){(t.width!==this.maxSize.width||t.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/t.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/t.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/t.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/t.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const e=+t.key;e>=1&&e<=9&&(this.settings.stepSize=e)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const r=t.shiftKey?y.Resize:y.Move,a=t.altKey?function at(s){switch(s){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function rt(s){switch(s){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),o=function ot(s,c){switch(s){case"ArrowUp":return{clientX:0,clientY:-1*c};case"ArrowRight":return{clientX:c,clientY:0};case"ArrowDown":return{clientX:0,clientY:c};default:return{clientX:-1*c,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},r,a),this.handleMouseMove(o),this.handleMouseUp()}startMove(t,e,r=null){var a,o;this.disabled||null!==(a=this.moveStart)&&void 0!==a&&a.active&&(null===(o=this.moveStart)||void 0===o?void 0:o.type)===y.Pinch||e===y.Drag&&!this.allowMoveImage||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:e,position:r,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t),...this.cropper},this.initMouseMove())}initMouseMove(){g((0,f.R)(document,"mousemove"),(0,f.R)(document,"touchmove")).pipe((0,W.Q)(g((0,f.R)(document,"mouseup"),(0,f.R)(document,"touchend")).pipe((0,F.$)()))).subscribe({next:t=>this.zone.run(()=>{this.handleMouseMove(t),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(t){this.safeImgDataUrl&&(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:y.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}handleMouseMove(t){if(this.moveStart.active)if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===y.Move)this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===y.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===y.Drag){var e,r;const a=this.cropperPositionService.getClientX(t)-this.moveStart.clientX,o=this.cropperPositionService.getClientY(t)-this.moveStart.clientY;this.transform={...this.transform,translateH:((null===(e=this.moveStart.transform)||void 0===e?void 0:e.translateH)||0)+a,translateV:((null===(r=this.moveStart.transform)||void 0===r?void 0:r.translateV)||0)+o},this.setCssTransform()}}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===y.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){const t=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(t.width),this.maxSize.height=parseFloat(t.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){var t;null!==(t=this.loadedImage)&&void 0!==t&&null!==(t=t.transformed)&&void 0!==t&&t.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){var t;if(null!==(t=this.loadedImage)&&void 0!==t&&null!==(t=t.transformed)&&void 0!==t&&t.image){const e=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/e:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/e:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){var t;this.moveStart.active&&(this.moveStart.active=!1,(null===(t=this.moveStart)||void 0===t?void 0:t.type)===y.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(t=this.settings.output){var e;if(null!=(null===(e=this.loadedImage)||void 0===e||null===(e=e.transformed)||void 0===e?void 0:e.image)){if(this.startCropImage.emit(),"blob"===t)return this.cropToBlob();if("base64"===t)return this.cropToBase64()}return null}cropToBlob(){var t=this;return new Promise((e,r)=>this.zone.run((0,C.A)(function*(){const a=yield t.cropService.crop(t.loadedImage,t.cropper,t.settings,"blob",t.maxSize);a?(t.imageCropped.emit(a),e(a)):r("Crop image failed")})))}cropToBase64(){const t=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return t?(this.imageCropped.emit(t),t):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return s.\u0275fac=function(t){return new(t||s)(i.rXU(st),i.rXU(ct),i.rXU(dt),i.rXU(_.up),i.rXU(i.gRc),i.rXU(i.SKi),i.rXU(_.Bn,8))},s.\u0275cmp=i.VBU({type:s,selectors:[["image-cropper"]],viewQuery:function(t,e){if(1&t&&(i.GBs(V,7),i.GBs(Z,5)),2&t){let r;i.mGM(r=i.lsd())&&(e.wrapper=r.first),i.mGM(r=i.lsd())&&(e.sourceImage=r.first)}},hostVars:6,hostBindings:function(t,e){1&t&&i.bIt("resize",function(){return e.onResize()},!1,i.tSv),2&t&&(i.xc7("text-align",e.alignImage),i.AVh("disabled",e.disabled)("ngx-ix-hidden",e.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[i.OA$],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(i.j41(0,"div",null,0),i.DNE(2,q,2,8,"img",2),i.nrm(3,"div",3),i.DNE(4,et,3,16,"div",4),i.k0s()),2&t&&(i.xc7("background",e.imageVisible&&e.backgroundColor),i.R7$(2),i.Y8G("ngIf",e.safeImgDataUrl),i.R7$(),i.xc7("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),i.R7$(),i.Y8G("ngIf",e.imageVisible))},dependencies:[R.bT],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),s})(),ut=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=i.$C({type:s}),s.\u0275inj=i.G2t({imports:[[R.MD]]}),s})()}}]);