"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4809],{8933:(y,p,l)=>{l.d(p,{Jb:()=>f,LK:()=>s,ru:()=>g});var g=function(d){return d.Prompt="PROMPT",d.Camera="CAMERA",d.Photos="PHOTOS",d}(g||{}),f=function(d){return d.Rear="REAR",d.Front="FRONT",d}(f||{}),s=function(d){return d.Uri="uri",d.Base64="base64",d.DataUrl="dataUrl",d}(s||{})},1889:(y,p,l)=>{l.d(p,{Wi:()=>f,__:()=>g});var g=function(r){return r.Documents="DOCUMENTS",r.Data="DATA",r.Library="LIBRARY",r.Cache="CACHE",r.External="EXTERNAL",r.ExternalStorage="EXTERNAL_STORAGE",r}(g||{}),f=function(r){return r.UTF8="utf8",r.ASCII="ascii",r.UTF16="utf16",r}(f||{})},4809:(y,p,l)=>{l.r(p),l.d(p,{HomePageModule:()=>X});var g=l(177),f=l(4341),s=l(9364),d=l(1277),r=l(467),j=l(6955),P=l(3349),e=l(4438),I=l(5083),b=l(8933);const R=(0,I.F3)("Camera",{web:()=>l.e(9141).then(l.bind(l,9141)).then(o=>new o.CameraWeb)});var v=l(1889);const h=(0,I.F3)("Filesystem",{web:()=>l.e(2937).then(l.bind(l,2937)).then(o=>new o.FilesystemWeb)});var S=l(4517);let E=(()=>{var o;class c{constructor(n,t,a){this.platform=n,this.loadingCtrl=t,this.toastCtrl=a,this.IMG_DIR="stored-images",this.images=[],this.convertBlobToBase64=m=>new Promise((u,F)=>{const _=new FileReader;_.onerror=F,_.onload=()=>{u(_.result)},_.readAsDataURL(m)})}formatDate(){const n=new Date;return n.getFullYear()+(n.getMonth()+1).toString().padStart(2,"0")+n.getDate()+"_"+n.getHours().toString().padStart(2,"0")+n.getMinutes().toString().padStart(2,"0")+n.getSeconds().toString().padStart(2,"0")}saveImage(n){var t=this;return(0,r.A)(function*(){let a;a=t.platform.is("hybrid")?yield t.readAsBase64_hybrid(n):yield t.readAsBase64_web(n.webPath);const u=t.formatDate()+".jpeg";yield h.writeFile({path:`${t.IMG_DIR}/${u}`,data:a,directory:v.__.Data}),t.loadFiles(),t.presentToast("File saved")})()}updateImage(n){var t=this;return(0,r.A)(function*(){const a=yield t.readAsBase64_web(n.edited),u=t.formatDate()+"_edited.jpeg";yield h.writeFile({path:`${t.IMG_DIR}/${u}`,data:a,directory:v.__.Data}),t.loadFiles(),t.presentToast("File updated")})()}readAsBase64_hybrid(n){return(0,r.A)(function*(){return(yield h.readFile({path:n.path})).data})()}readAsBase64_web(n){var t=this;return(0,r.A)(function*(){const m=yield(yield fetch(n)).blob();return yield t.convertBlobToBase64(m)})()}takeImage(){var n=this;return(0,r.A)(function*(){try{const t=yield R.getPhoto({resultType:b.LK.Uri,source:b.ru.Camera,quality:100});t.webPath&&(yield n.saveImage(t))}catch{console.log("no photo")}})()}loadImage(){var n=this;return(0,r.A)(function*(){try{const t=yield R.getPhoto({resultType:b.LK.Uri,source:b.ru.Photos,quality:100});t&&(yield n.saveImage(t))}catch{console.log("no photo")}})()}loadFiles(){var n=this;return(0,r.A)(function*(){n.images=[];const t=yield n.loadingCtrl.create({message:"loading images..."});yield t.present(),h.readdir({path:n.IMG_DIR,directory:v.__.Data}).then(a=>{n.loadFileData(a.files.map(m=>m.name))},function(){var a=(0,r.A)(function*(m){console.log("error loading: "+m),yield h.mkdir({directory:v.__.Data,path:n.IMG_DIR})});return function(m){return a.apply(this,arguments)}}()).then(a=>{t.dismiss()})})()}loadFileData(n){var t=this;return(0,r.A)(function*(){for(let a of n){const m=`${t.IMG_DIR}/${a}`,u=localStorage.getItem(a),F=yield h.readFile({path:m,directory:v.__.Data});t.images.unshift({name:a,path:m,data:`data:image/jpeg;base64,${F.data}`,edited:"",details:u})}})()}deleteImage(n){var t=this;return(0,r.A)(function*(){yield h.deleteFile({directory:v.__.Data,path:n.path}),localStorage.removeItem(n.name),t.loadFiles(),t.presentToast("File removed")})()}presentToast(n){var t=this;return(0,r.A)(function*(){(yield t.toastCtrl.create({message:n,duration:3e3})).present()})()}}return(o=c).\u0275fac=function(n){return new(n||o)(e.KVO(S.OD),e.KVO(s.Xi),e.KVO(s.K_))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),c})();var A=l(1626);let H=(()=>{var o;class c{constructor(n){this.http=n,this.URL_ROOT="https://35.222.94.6/CNN",this.analyzing=!1}analyze(n){var t=this;return(0,r.A)(function*(){return console.log("this.analyzing: ",t.analyzing),t.http.post(t.URL_ROOT,{id:123,image:n}).toPromise()})()}}return(o=c).\u0275fac=function(n){return new(n||o)(e.KVO(A.Qq))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),c})();function T(o,c){1&o&&(e.j41(0,"ion-row")(1,"p"),e.EFF(2,"analyzing..."),e.k0s()())}function $(o,c){if(1&o&&(e.j41(0,"ion-col",15)(1,"p"),e.EFF(2,"Nombre: "),e.j41(3,"strong"),e.EFF(4),e.k0s()(),e.j41(5,"p"),e.EFF(6,"Probabilidad: "),e.j41(7,"strong"),e.EFF(8),e.nI1(9,"number"),e.k0s()()()),2&o){const i=e.XpG(2);e.R7$(4),e.JRh(i.results.result.names[0]),e.R7$(4),e.JRh(e.i5U(9,2,i.results.result.probs[0],"0.1-4"))}}function k(o,c){if(1&o&&(e.j41(0,"ion-col",15)(1,"p"),e.EFF(2,"Nombre: "),e.j41(3,"strong"),e.EFF(4),e.k0s()(),e.j41(5,"p"),e.EFF(6,"Probabilidad: "),e.j41(7,"strong"),e.EFF(8),e.nI1(9,"number"),e.k0s()()()),2&o){const i=e.XpG(2);e.R7$(4),e.JRh(i.results.result.names[1]),e.R7$(4),e.JRh(e.i5U(9,2,i.results.result.probs[1],"0.1-4"))}}function D(o,c){if(1&o&&(e.j41(0,"ion-col",15)(1,"p"),e.EFF(2,"Nombre: "),e.j41(3,"strong"),e.EFF(4),e.k0s()(),e.j41(5,"p"),e.EFF(6,"Probabilidad: "),e.j41(7,"strong"),e.EFF(8),e.nI1(9,"number"),e.k0s()()()),2&o){const i=e.XpG(2);e.R7$(4),e.JRh(i.results.result.names[2]),e.R7$(4),e.JRh(e.i5U(9,2,i.results.result.probs[2],"0.1-4"))}}function G(o,c){if(1&o&&(e.j41(0,"ion-col",15)(1,"p"),e.EFF(2,"Nombre: "),e.j41(3,"strong"),e.EFF(4),e.k0s()(),e.j41(5,"p"),e.EFF(6,"Probabilidad: "),e.j41(7,"strong"),e.EFF(8),e.nI1(9,"number"),e.k0s()()()),2&o){const i=e.XpG(2);e.R7$(4),e.JRh(i.results.result.names[3]),e.R7$(4),e.JRh(e.i5U(9,2,i.results.result.probs[3],"0.1-4"))}}function z(o,c){if(1&o&&(e.j41(0,"ion-row"),e.DNE(1,$,10,5,"ion-col",14)(2,k,10,5,"ion-col",14)(3,D,10,5,"ion-col",14)(4,G,10,5,"ion-col",14),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngIf",i.results),e.R7$(),e.Y8G("ngIf",i.results),e.R7$(),e.Y8G("ngIf",i.results),e.R7$(),e.Y8G("ngIf",i.results)}}function C(o,c){if(1&o&&(e.j41(0,"ion-card-content",27),e.EFF(1),e.k0s()),2&o){const i=e.XpG().$implicit;e.R7$(),e.SpI(" ",i.details," ")}}function M(o,c){if(1&o){const i=e.RV6();e.j41(0,"ion-col",16)(1,"ion-card",17),e.nrm(2,"ion-img",18),e.j41(3,"ion-card-header",19)(4,"ion-card-subtitle"),e.EFF(5),e.k0s()(),e.nrm(6,"br"),e.DNE(7,C,2,1,"ion-card-content",20),e.j41(8,"ion-button",21),e.bIt("click",function(){const t=e.eBV(i).$implicit,a=e.XpG();return e.Njj(a.analyze(t))}),e.nrm(9,"ion-icon",22),e.j41(10,"ion-label"),e.EFF(11,"Analyze image"),e.k0s()(),e.j41(12,"ion-button",23),e.bIt("click",function(){const t=e.eBV(i).$implicit,a=e.XpG();return e.Njj(a.editImage(t))}),e.nrm(13,"ion-icon",24),e.j41(14,"ion-label"),e.EFF(15,"Edit image"),e.k0s()(),e.j41(16,"ion-button",23),e.bIt("click",function(){const t=e.eBV(i).$implicit,a=e.XpG();return e.Njj(a.editInfo(t))}),e.nrm(17,"ion-icon",24),e.j41(18,"ion-label"),e.EFF(19,"Edit info"),e.k0s()(),e.j41(20,"ion-button",25),e.bIt("click",function(){const t=e.eBV(i).$implicit,a=e.XpG();return e.Njj(a.deleteImage(t))}),e.nrm(21,"ion-icon",26),e.j41(22,"ion-label"),e.EFF(23,"Remove"),e.k0s()()()()}if(2&o){const i=c.$implicit;e.R7$(2),e.Y8G("src",i.data),e.R7$(3),e.JRh(i.name),e.R7$(2),e.Y8G("ngIf",i.details)}}const N=[{path:"",component:(()=>{var o;class c{constructor(n,t,a){this.cameraService=n,this.serverService=t,this.modalCtrl=a,this.images=[],this.results={result:{index:[],names:[],probs:[]}}}ngOnInit(){}ionViewDidEnter(){this.cameraService.loadFiles(),this.images=this.cameraService.images}takeImage(){var n=this;return(0,r.A)(function*(){yield n.cameraService.takeImage(),n.images=n.cameraService.images})()}loadImage(){var n=this;return(0,r.A)(function*(){yield n.cameraService.loadImage(),n.images=n.cameraService.images})()}editImage(n){var t=this;return(0,r.A)(function*(){const a=yield t.modalCtrl.create({component:j.o,componentProps:{image:n}});return a.onDidDismiss().then(m=>{const u=m.data;null!=u&&t.updateImage(u)}),yield a.present()})()}editInfo(n){var t=this;return(0,r.A)(function*(){return yield(yield t.modalCtrl.create({component:P.P,componentProps:{image:n}})).present()})()}updateImage(n){var t=this;return(0,r.A)(function*(){yield t.cameraService.updateImage(n),t.images=t.cameraService.images})()}deleteImage(n){var t=this;return(0,r.A)(function*(){yield t.cameraService.deleteImage(n),t.images=t.cameraService.images})()}analyze(n){var t=this;return(0,r.A)(function*(){var m=n.data.split(",")[1];if(t.serverService.analyzing)console.log("analyzing...");else{t.serverService.analyzing=!0;var u=yield t.serverService.analyze(m);t.serverService.analyzing=!1,t.results=u,console.log("results: ",u)}})()}}return(o=c).\u0275fac=function(n){return new(n||o)(e.rXU(E),e.rXU(H),e.rXU(s.W3))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-home"]],decls:24,vars:5,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngIf"],["size","12","size-Xs","6","size-sm","6","size-Md","3",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","wood"],["name","add"],["side","top"],["color","wood-second",3,"click"],["name","attach"],["name","camera"],["size","12","sizeXs","3",4,"ngIf"],["size","12","sizeXs","3"],["size","12","size-Xs","6","size-sm","6","size-Md","3"],["color","wood",2,"padding","0.5em"],["alt","image",2,"height","10em",3,"src"],[2,"padding","0","padding-top","1em"],["style","padding: 0; padding-bottom: 1em;",4,"ngIf"],["expand","full","color","cocobolo",3,"click"],["slot","start","name","search-outline"],["expand","full","color","medium",3,"click"],["slot","start","name","create-outline"],["expand","full","color","danger",3,"click"],["slot","start","name","trash-outline"],[2,"padding","0","padding-bottom","1em"]],template:function(n,t){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Home"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e.EFF(10,"Home"),e.k0s()()(),e.j41(11,"ion-grid"),e.DNE(12,T,3,0,"ion-row",5)(13,z,5,4,"ion-row",5),e.j41(14,"ion-row"),e.DNE(15,M,24,3,"ion-col",6),e.k0s()(),e.j41(16,"ion-fab",7)(17,"ion-fab-button",8),e.nrm(18,"ion-icon",9),e.k0s(),e.j41(19,"ion-fab-list",10)(20,"ion-fab-button",11),e.bIt("click",function(){return t.loadImage()}),e.nrm(21,"ion-icon",12),e.k0s(),e.j41(22,"ion-fab-button",11),e.bIt("click",function(){return t.takeImage()}),e.nrm(23,"ion-icon",13),e.k0s()()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(6),e.Y8G("ngIf",t.serverService.analyzing),e.R7$(),e.Y8G("ngIf",!t.serverService.analyzing),e.R7$(2),e.Y8G("ngForOf",t.images))},dependencies:[g.Sq,g.bT,s.Jm,s.QW,s.b_,s.I9,s.ME,s.HW,s.hU,s.W9,s.Q8,s.YW,s.OL,s.lO,s.eU,s.iq,s.KW,s.he,s.MC,s.ln,s.BC,s.ai,g.QX]}),c})()}];let U=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[d.iI.forChild(N),d.iI]}),c})(),X=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.MD,f.YN,s.bv,U]}),c})()}}]);